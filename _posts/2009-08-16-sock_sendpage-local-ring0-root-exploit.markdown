---
layout: post
status: publish
published: true
title: Sock_sendpage() Local Ring0 Root Exploit
author:
  display_name: admin
  login: admin
  email: combbs@gmail.com
  url: http://seaprince.cn/
author_login: admin
author_email: combbs@gmail.com
author_url: http://seaprince.cn/
wordpress_id: 454
wordpress_url: http://seaprince.cn/sock_sendpage-local-ring0-root-exploit/
date: !binary |-
  MjAwOS0wOC0xNiAyMTo1NTo1NyArMDgwMA==
date_gmt: !binary |-
  MjAwOS0wOC0xNiAxMzo1NTo1NyArMDgwMA==
categories:
- 服务器
tags: []
comments: []
---
<p>昨天Linux世界又爆高危漏洞。攻击方法非常简单，只需要下载一个包，执行其中的脚本文件即可以获取root权限。</p>
<pre><code>攻击包下载：<a href="http:&#47;&#47;www.grsecurity.net&#47;~spender&#47;wunderbar_emporium.tgz"><span style="color: blue; text-decoration: underline;">http:&#47;&#47;www.grsecurity.net&#47;~spender&#47;wunderbar_emporium.tgz<&#47;span><&#47;a><span style="color:black"><br />
				<&#47;span><&#47;code><&#47;pre></p>
<pre><code><span style="color:black">本地备份包：<a href="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;hack&#47;wunderbar_emporium.tgz"><&#47;a><&#47;span><span style="color: blue; text-decoration: underline;"><a href="http:&#47;&#47;blog.eaxi.com&#47;files&#47;wunderbar_emporium-3.tgz">http:&#47;&#47;blog.eaxi.com&#47;files&#47;wunderbar_emporium-3.tgz<&#47;a><&#47;span><span style="color:black"><br />
<&#47;span><&#47;code><&#47;pre><br />
&nbsp;</p>
<p>攻击成功截图：</p>
<p><img src="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;2009&#47;08&#47;081609_1356_Socksendpag1.png" alt="" &#47;></p>
<p>grsec又一次立下汗马功劳：</p>
<p><img src="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;2009&#47;08&#47;081609_1356_Socksendpag2.png" alt="" &#47;></p>
<p>&nbsp;</p>
<p>在重现这个问题的时候，我注意到了还有另外一个BUG：<a href="http:&#47;&#47;www.milw0rm.com&#47;exploits&#47;9436" target="_blank"><span style="color:#f87431; font-family:Verdana; font-size:7pt"><strong>Linux Kernel 2.x sock_sendpage() Local Root Exploit #2<&#47;strong><&#47;span><&#47;a><span style="color:lime; font-family:Verdana; font-size:7pt"><strong><br />
<&#47;strong><&#47;span></p>
<p>随便也重现一下看：</p>
<pre><code>下载：<a href="http:&#47;&#47;www.frasunek.com&#47;proto_ops.tgz"><span style="color: blue; text-decoration: underline;">http:&#47;&#47;www.frasunek.com&#47;proto_ops.tgz<&#47;span><&#47;a><span style="color:black"><br />
				<&#47;span><&#47;code><&#47;pre></p>
<pre><code><span style="color:black">本地备份包：<a href="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;hack&#47;proto_ops.tgz"><&#47;a><&#47;span><span style="color: blue; text-decoration: underline;"><a href="http:&#47;&#47;blog.eaxi.com&#47;files&#47;proto_ops.tgz">http:&#47;&#47;blog.eaxi.com&#47;files&#47;proto_ops.tgz<&#47;a><&#47;span><&#47;code><&#47;pre></p>
<pre><img src="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;2009&#47;08&#47;081609_1356_Socksendpag3.png" alt="" &#47;><&#47;pre><br />
在grsec下的表现：</p>
<p><img src="http:&#47;&#47;blog.eaxi.com&#47;wp-content&#47;uploads&#47;2009&#47;08&#47;081609_1356_Socksendpag4.png" alt="" &#47;></p>
<p>可见这个grsec补丁的强悍！</p>
<p>如果你在使用deb，官方提供的补丁可能太老了，不适合你。这时，你可以考虑使用我编译的带补丁内核。</p>
<p>补丁下载：<a href="http:&#47;&#47;blog.eaxi.com&#47;files&#47;linux-image-2.6.27.10sihost-grsec_i386.deb">http:&#47;&#47;blog.eaxi.com&#47;files&#47;linux-image-2.6.27.10sihost-grsec_i386.deb<&#47;a></p>
<p>介绍网址：<a href="http:&#47;&#47;blog.sihost.net&#47;linux-image-2-6-27-10sihost-grsec_i386-deb.html">http:&#47;&#47;blog.sihost.net&#47;linux-image-2-6-27-10sihost-grsec_i386-deb.html<&#47;a></p>
<p>更新：</p>
<p>2009-09-01 更新本地缓存包路径。</p>
<p>--EOF--</p>
