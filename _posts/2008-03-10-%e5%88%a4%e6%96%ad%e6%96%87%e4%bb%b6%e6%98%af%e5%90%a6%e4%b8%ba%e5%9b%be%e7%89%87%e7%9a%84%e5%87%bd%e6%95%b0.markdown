---
layout: post
status: publish
published: true
title: 判断文件是否为图片的函数
author:
  display_name: admin
  login: admin
  email: combbs@gmail.com
  url: http://seaprince.cn/
author_login: admin
author_email: combbs@gmail.com
author_url: http://seaprince.cn/
excerpt: ! "<p>一个自我感觉不错的判断一个文件是否为合格图片的函数。</p>\r\n<p>如果怕getimagesize会耗资源，可以不要这一个。</p>"
wordpress_id: 188
date: !binary |-
  MjAwOC0wMy0xMCAxNzo1MTowMiArMDgwMA==
date_gmt: !binary |-
  MjAwOC0wMy0xMCAwOTo1MTowMiArMDgwMA==
categories:
- 个人作品
tags:
- php
comments: []
---
<div class="codeText">
<div class="codeHead">PHP代码<&#47;div></p>
<ol class="dp-c">
<li class="alt"><span><span class="comment">&#47;** <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class=""><span><span class="comment">&nbsp;*&nbsp;Detect&nbsp;if&nbsp;a&nbsp;file&nbsp;is&nbsp;valid&nbsp;image&nbsp;file <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class="alt"><span><span class="comment">&nbsp;* <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class=""><span><span class="comment">&nbsp;*&nbsp;@param&nbsp;String&nbsp;$file <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class="alt"><span><span class="comment">&nbsp;*&nbsp;@return&nbsp;Boolean <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class=""><span><span class="comment">&nbsp;*&nbsp;@author&nbsp;Seaprince <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class="alt"><span><span class="comment">&nbsp;*&nbsp;@since&nbsp;10&#47;3&#47;2008 <&#47;span>&nbsp;<&#47;span><&#47;li>
<li class=""><span><span class="comment">&nbsp;*&#47;<&#47;span><span>&nbsp;&nbsp;<&#47;span><&#47;span><&#47;li>
<li class="alt"><span class="keyword">function<&#47;span><span>&nbsp;is_image_file(<&#47;span><span class="vars">$file<&#47;span><span>)&nbsp;{ &nbsp;&nbsp;<&#47;span><&#47;li>
<li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="comment">&#47;&#47;&nbsp;Pass&nbsp;1 <&#47;span><span>&nbsp;&nbsp;<&#47;span><&#47;li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="keyword">if<&#47;span><span>&nbsp;(!<&#47;span><span class="func">is_file<&#47;span><span>(<&#47;span><span class="vars">$file<&#47;span><span>))&nbsp;<&#47;span><span class="keyword">return<&#47;span><span>&nbsp;false; &nbsp;&nbsp;<&#47;span><&#47;li>
<li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="comment">&#47;&#47;&nbsp;Pass&nbsp;2 <&#47;span><span>&nbsp;&nbsp;<&#47;span><&#47;li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="vars">$allowed_ext<&#47;span><span>&nbsp;=&nbsp;<&#47;span><span class="keyword">array<&#47;span><span>(<&#47;span><span class="string">'.jpg'<&#47;span><span>,<&#47;span><span class="string">'.gif'<&#47;span><span>,<&#47;span><span class="string">'.png'<&#47;span><span>); &nbsp;&nbsp;<&#47;span><&#47;li>
<li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="vars">$ext<&#47;span><span>&nbsp;=&nbsp;<&#47;span><span class="func">strtolower<&#47;span><span>(<&#47;span><span class="func">strrchr<&#47;span><span>(<&#47;span><span class="vars">$file<&#47;span><span>,<&#47;span><span class="string">'.'<&#47;span><span>)); &nbsp;&nbsp;<&#47;span><&#47;li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="keyword">if<&#47;span><span>&nbsp;(!in_array(<&#47;span><span class="vars">$ext<&#47;span><span>,&nbsp;<&#47;span><span class="vars">$allowed_ext<&#47;span><span>))&nbsp;<&#47;span><span class="keyword">return<&#47;span><span>&nbsp;false; &nbsp;&nbsp;<&#47;span><&#47;li>
<li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="comment">&#47;&#47;&nbsp;Pass&nbsp;3 <&#47;span><span>&nbsp;&nbsp;<&#47;span><&#47;li>
<li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;list(<&#47;span><span class="vars">$w<&#47;span><span>,<&#47;span><span class="vars">$h<&#47;span><span>,<&#47;span><span class="vars">$t<&#47;span><span>,<&#47;span><span class="vars">$a<&#47;span><span>)&nbsp;=&nbsp;@<&#47;span><span class="func">getimagesize<&#47;span><span>(<&#47;span><span class="vars">$file<&#47;span><span>); &nbsp;&nbsp;<&#47;span><&#47;li>
<li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<&#47;span><span class="keyword">return<&#47;span><span>&nbsp;<&#47;span><span class="vars">$w<&#47;span><span>&nbsp;&amp;&amp;&nbsp;<&#47;span><span class="vars">$h<&#47;span><span>&nbsp;&amp;&amp;&nbsp;<&#47;span><span class="vars">$t<&#47;span><span>&nbsp;&amp;&amp;&nbsp;<&#47;span><span class="vars">$a<&#47;span><span>; &nbsp;&nbsp;<&#47;span><&#47;li>
<li class="alt"><span>}&nbsp;&nbsp;<&#47;span><&#47;li><br />
<&#47;ol><br />
<&#47;div></p>
<p>一个自我感觉不错的判断一个文件是否为合格图片的函数。<&#47;p></p>
<p>如果怕getimagesize会耗资源，可以不要这一个。<&#47;p></p>
